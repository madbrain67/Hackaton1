{% extends 'base.html.twig' %}
{% block title %}Jackpot Hackaton{% endblock %}
{% block stylesheets %}
{#<link rel="stylesheet" href="css/slotmachine.css">#}

<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/slotmachine.css" type="text/css" media="screen" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" type="text/css" />
{% endblock %}


{% block body %}
<div class="container-fluid" style="background:#fff;">
    <div class="row">
        <div class="col-12">
            <h1 class="text-center" style="color:#000;"> Egg fact<a href="#" alt="oeuf"><img src="../images/oeufentier.png" 
            style="width:44px;height:54px;" id="oeufentier"></a>ry!<img src="../images/lapin7.gif" 
            style="width:144px;height:154px;" id="lapi">
            </h1>
        </div>
    </div>
</div>

<div class="container-fluid mb-3">
    <div class="row">

        <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6 col-xl-6 background">
            <div id="randomize">
                <div class="container">

                        <div class="row">
                            <div class="col-sm-4">
                                <div>
                                    <div id="machine1" class="randomizeMachine">
                                        {% for oeuf in oeufs | slice ( 0 , 9) %}
                                        <div><img src="{{ oeuf }}" style="width:100px;height:100px;" /></div>
                                        {% endfor %}

                                    </div>
                                </div>
                                <div id="machine1Result" class="col-xs-4 machineResult"></div>
                            </div>

                            <div class="col-sm-4">
                                <div>
                                    <div id="machine2" class="randomizeMachine">
                                        {% for oeuf in oeufs | slice ( 0 , 9) %}
                                        <div><img src="{{ oeuf }}" style="width:100px;height:100px;" /></div>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div id="machine2Result" class="col-xs-4 machineResult"></div>
                            </div>

                            <div class="col-sm-4">
                                <div>
                                    <div id="machine3" class="randomizeMachine">
                                        {% for oeuf in oeufs | slice ( 0 , 9) %}
                                        <div><img src="{{ oeuf }}" style="width:100px;height:100px;" /></div>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div id="machine3Result" class="col-xs-4 machineResult"></div>
                            </div>


                        </div><br>
                        <!--end 1 row-->
                        <div class="row">

                            <div class="col-sm-4">
                                <div>
                                    <div id="machine4" class="randomizeMachine">
                                        {% for oeuf in oeufs | slice ( 0 , 9) %}
                                        <div><img src="{{ oeuf }}" style="width:100px;height:100px;" /></div>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div id="machine4Result" class="col-xs-4 machineResult"></div>
                            </div>
                            <div class="col-sm-4">
                                <div>
                                    <div id="machine5" class="randomizeMachine">
                                        {% for oeuf in oeufs | slice ( 0 , 9) %}
                                        <div><img src="{{ oeuf }}" style="width:100px;height:100px;" /></div>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div id="machine5Result" class="col-xs-4 machineResult"></div>
                            </div>
                            <div class="col-sm-4">
                                <div>
                                    <div id="machine6" class="randomizeMachine">
                                        {% for oeuf in oeufs | slice ( 0 , 9) %}
                                        <div><img src="{{ oeuf }}" style="width:100px;height:100px;" /></div>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div id="machine6Result" class="col-xs-4 machineResult"></div>
                            </div>

                        </div>

                        <div class="btn-group btn-group-justified" role="group">
                            <button id="randomizeButton" type="button" class="btn btn-danger btn-lg">JOUER</button>
                        </div>

                        <div class="btn-group btn-group-justified" style="background:white;width:200px;padding:10px;">
                            <div id="gagner">No gain</div>
                        </div>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3 col-xl-3">
            {% for perso in personnage  %}
                {% if perso.id == app.jeu.personnage %}
                <div class="card">
                    <img src="{{ perso.image }}" class="card-img-top" alt="{{ perso.name }}">
                    <div class="card-body">
                        <h5 class="card-title">{{ perso.name }}</h5>
                        <p class="card-text">Some quick example.</p>
                    </div>
                </div>
                {% endif %}
            {% endfor %}
        </div>

        <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3 col-xl-3">
            <div class="card" style="width: 15rem;border-radius:20px;">

                <div class="card-body">
                <div class="mb-2 text-center"><h2>Gains</h2></div>
                    <div class="mega-score">
                    <img src="../images/score.png" style="width:200px;">
                    <div id="gain" class="text-center gain">{{ gain }}</div>
                    </div>
                </div>
            </div>


            <div class="card mt-4" style="width: 15rem;">
				<div class="card-header">
					Top 5 score
				</div>
				<ul class="list-group list-group-flush">
					<li class="list-group-item"><img src="https://images-na.ssl-images-amazon.com/images/I/91P9Csqk5RL.jpg" width="20"> Judge Dredd: <b>150154</b></li>
					<li class="list-group-item"><img src="https://www.derivstore.com/wp-content/uploads/2017/11/Figurine-Hot-Toys-Harley-Quinn-3.jpg" width="20"> Harley Quinn: <b>145015</b></li>
					<li class="list-group-item"><img src="https://static.comicvine.com/uploads/scale_small/13/132327/4262699-a86be31143ba35176665964cfa29516a-d5qg94n.jpg" width="20"> Gandalf: <b>140128</b></li>
					<li class="list-group-item"><img src="https://klausming.files.wordpress.com/2011/09/brian.jpg" width="20"> Brian Cohen: <b>120025</b></li>
					<li class="list-group-item"><img src="https://upload.wikimedia.org/wikipedia/en/thumb/2/2a/Supergirl_%28Kara_Zor-El%29_-DC_Rebirth_version-.jpg/250px-Supergirl_%28Kara_Zor-El%29_-DC_Rebirth_version-.jpg" width="20"> Supergirl: <b>110456</b></li>
				</ul>
			</div>

        </div>

    </div>
</div>

<div id="aaa"></div>
{% endblock %}

{% block javascripts %}

<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="../js/slotmachine.js"></script>
<script src="../js/jquery.slotmachine.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.10/js/all.js"></script>
<script>
    $("#oeufentier").click(function () {
        $(this).attr("src", "/images/oeuf.png");
    });
</script>

<script>
$(document).ready(function() {
    console.log($.ajax);
});
</script>

<script id="codeScript2">

    const btn = document.querySelector('#randomizeButton');
    const results = {
        machine1: document.querySelector('#machine1Result'),
        machine2: document.querySelector('#machine2Result'),
        machine3: document.querySelector('#machine3Result'),
        machine4: document.querySelector('#machine4Result'),
        machine5: document.querySelector('#machine5Result'),
        machine6: document.querySelector('#machine6Result')
    };
    const el1 = document.querySelector('#machine1');
    const el2 = document.querySelector('#machine2');
    const el3 = document.querySelector('#machine3');
    const el4 = document.querySelector('#machine4');
    const el5 = document.querySelector('#machine5');
    const el6 = document.querySelector('#machine6');
    const machine1 = new SlotMachine(el1, {
        active: 0
    });
    const machine2 = new SlotMachine(el2, {
        active: 1
    });
    const machine3 = new SlotMachine(el3, {
        active: 2
    });
    const machine4 = new SlotMachine(el4, {
        active: 3
    });
    const machine5 = new SlotMachine(el5, {
        active: 4
    });
    const machine6 = new SlotMachine(el6, {
        active: 5
    });


    function counter(tableau) {
        //alert(tableau);
        var myCurrentArray = tableau;

        var counts = {};

        for(var i=0;i< myCurrentArray.length;i++)
        {
        var key = myCurrentArray[i];
        counts[key] = (counts[key])? counts[key] + 1 : 1 ;

        }
        
        var combinaison = new Array();
        combinaison.push(counts['0']);
        combinaison.push(counts['1']);
        combinaison.push(counts['2']);
        combinaison.push(counts['3']);
        combinaison.push(counts['4']);
        combinaison.push(counts['5']);
        combinaison.push(counts['6']);
        combinaison.push(counts['7']);
        combinaison.push(counts['8']);

        //alert(combinaison);
        
        var prize = 0; 
        
        for(u=0;u<combinaison.length;u++) {
            switch (combinaison[u])
            {
                case 2:
                prize += 2;
                break;
                case 3:
                prize += 10;
                break;
                case 4:
                prize += 30;
                break;
                case 5:
                prize += 50;
                break;
                case 6:
                prize += 100;
                break;
                default: 
                prize += 0;
            }
        }
        //alert(prize);

        $("#gagner").text('Gain:' + prize);

        var gains = $("#gain").text();
        var $newGains = parseInt(gains) + parseInt(prize);
        $("#gain").text($newGains);
    }
    
    function startCounter(){
        $("#gagner").text('No gain');
        var scored = new Array();
        return scored;
    }

    function onComplete(active) {
        results[this.element.id].innerText = `${this.active}`;
        scored.push(`${this.active}`);
    }

    btn.addEventListener('click', () => {
        scored = startCounter();
        machine1.shuffle(5, onComplete);
        setTimeout(() => machine2.shuffle(5, onComplete), 300);
        setTimeout(() => machine3.shuffle(5, onComplete), 600);
        setTimeout(() => machine4.shuffle(5, onComplete), 900);
        setTimeout(() => machine5.shuffle(5, onComplete), 1200);
        setTimeout(() => machine6.shuffle(5, onComplete), 1500);
        setTimeout(() => counter(scored), 3000);
    });

</script>

<script>
$("#randomizeButton").click(function( event ){
    event.preventDefault();
    var gains = $("#gain").text();
    $("#gain").text(gains - 2);
});
</script>
{% endblock %}